<?php
session_start();
require '../db.php';

if (!isset($_SESSION['username'])) {
    header('Location: /logout');
    exit;
}

$user_name = $_SESSION['username'];

$stmt = $pdo->prepare('SELECT game_points FROM users WHERE username = :username');
$stmt->execute(['username' => $user_name]);
$user = $stmt->fetch();

if (!$user) {
    header('Location: /logout');
    exit;
}

$gamePoints = $user['game_points']; 

?>




<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Coconut Simulator</title>
  <script src="https://cdn.jsdelivr.net/npm/three@latest/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three/examples/js/loaders/GLTFLoader.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: "Roboto", serif;
      margin: 0;
      overflow: hidden;
      touch-action: none;
    }

    canvas {
      display: block;
    }

    #overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: url('../assets/background.webp') no-repeat center center/cover;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 10;
    }

    .playButton {
      padding: 15px 30px;
        width: 60%;
        max-width: 450px;
      font-size: 20px;
      font-weight: bold;
      background-color: rgba(255, 255, 255, 0.8);
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: 0.3s;
    }

    .playButton:hover {
      background-color: rgba(255, 255, 255, 1);
    }
    
     #points {
      position: fixed;
      z-index: 9999;
      left: 85%;
      top: 5%;
      background-color: green;
      padding: 5px 25px;
      font-size: 28px;
      justify-content: center;
      align-items: center;
      border-radius: 18px;
      color: white;
    }
     #voltar {
      position: fixed;
      z-index: 9999;
      right: 85%;
      top: 5%;
      background-color: gray;
      padding: 5px 25px;
      font-size: 28px;
      justify-content: center;
      align-items: center;
      border-radius: 18px;
      color: white;
    }
    
    @media screen and (max-width: 500px){
        #points {
    
      left: 55%;
      top: 5%;
      background-color: green;
      padding: 5px 25px;
      font-size: 20px;
      
    }
   #voltar {

      right: 55%;
      top: 5%;
      background-color: gray;
      padding: 5px 25px;
      font-size: 20px;
      
    }
    }
  </style>
 
</head>
<body>

  <div id="overlay">
    <button id="playButton" class="playButton">JOGAR</button>
    
    <button style="margin-top:12px;" onclick="window.location.href='/realist-mode'" class="playButton">MODO REALISTA</button>
    
    <button style="margin-top:12px;" onclick="window.location.href='/ranking'" class="playButton">RANKING</button>
    
    <p style="color: black; font-size: 18px; position: absolute; bottom: 20px;">Desenvolvido por <a style="text-decoration: none; color: purple;" href="https://daanrox.com/" target="_blank">DAANROX</a></p>
  </div>

 

<div id="pointsContainer" style="display: none; flex-direction: column; gap:8px; align-items: center; justify-content: space-between; width: 100%">
    <p id="points"><?php echo $gamePoints; ?> PONTOS</p> 
    <p onclick="window.location.href='/game'"  id="voltar" style="cursor: pointer;">VOLTAR</p> 
</div>



  <script>
    let points = <?php echo $gamePoints; ?>;
    const pointsElement = document.getElementById("points");

    function updatePointsDisplay() {
      pointsElement.textContent = `${points} PONTOS`;
    }


    setInterval(() => {
      points++;
      updatePointsDisplay();
    }, 3000);

    setInterval(() => {
      fetch('update_points.php', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ points })
      })
      .then(response => response.json())
      .then(data => console.log(data.message))
      .catch(error => console.error('Erro ao atualizar pontos:', error));
    }, 10000);
  </script>
  <script>
   const _0x16fa28=_0x406b;(function(_0x25ab9e,_0x1be28a){const _0x412eae=_0x406b,_0x2d8d40=_0x25ab9e();while(!![]){try{const _0x340a07=-parseInt(_0x412eae(0xff))/0x1*(-parseInt(_0x412eae(0xe0))/0x2)+parseInt(_0x412eae(0xbf))/0x3+parseInt(_0x412eae(0xcc))/0x4*(-parseInt(_0x412eae(0xf4))/0x5)+parseInt(_0x412eae(0xe7))/0x6+-parseInt(_0x412eae(0xc7))/0x7*(parseInt(_0x412eae(0xc1))/0x8)+-parseInt(_0x412eae(0xc6))/0x9+-parseInt(_0x412eae(0xc0))/0xa*(parseInt(_0x412eae(0xc3))/0xb);if(_0x340a07===_0x1be28a)break;else _0x2d8d40['push'](_0x2d8d40['shift']());}catch(_0xbd8cf8){_0x2d8d40['push'](_0x2d8d40['shift']());}}}(_0x136b,0x7945d));const _0x4e3234=_0x89c6;(function(_0xf604f4,_0x2034ec){const _0x574238=_0x406b,_0x27bac3=_0x89c6,_0x225da5=_0xf604f4();while(!![]){try{const _0x45a857=parseInt(_0x27bac3(0xc6))/0x1+parseInt(_0x27bac3(0xcb))/0x2+parseInt(_0x27bac3(0xd5))/0x3+-parseInt(_0x27bac3(0xc2))/0x4*(parseInt(_0x27bac3(0xe1))/0x5)+parseInt(_0x27bac3(0xee))/0x6+parseInt(_0x27bac3(0xdc))/0x7+parseInt(_0x27bac3(0xfe))/0x8*(-parseInt(_0x27bac3(0xfa))/0x9);if(_0x45a857===_0x2034ec)break;else _0x225da5[_0x574238(0xe3)](_0x225da5[_0x574238(0xdd)]());}catch(_0x4b2eae){_0x225da5[_0x574238(0xe3)](_0x225da5[_0x574238(0xdd)]());}}}(_0x1c65,0x3e850));function _0x3302(_0x52434c,_0x178ab3){const _0xe486b7=_0x3102();return _0x3302=function(_0x57d758,_0x260617){_0x57d758=_0x57d758-0x1c9;let _0x45048b=_0xe486b7[_0x57d758];return _0x45048b;},_0x3302(_0x52434c,_0x178ab3);}const _0x2974bd=_0x3302;(function(_0x4cd125,_0x31f1ee){const _0x4724d8=_0x406b,_0x429a1c=_0x89c6,_0x43cd31=_0x3302,_0x44a451=_0x4cd125();while(!![]){try{const _0x1e756a=parseInt(_0x43cd31(0x1f4))/0x1+parseInt(_0x43cd31(0x1e8))/0x2+parseInt(_0x43cd31(0x1ee))/0x3*(parseInt(_0x43cd31(0x1d7))/0x4)+parseInt(_0x43cd31(0x202))/0x5*(-parseInt(_0x43cd31(0x1f8))/0x6)+parseInt(_0x43cd31(0x1d1))/0x7*(parseInt(_0x43cd31(0x1f0))/0x8)+-parseInt(_0x43cd31(0x1e2))/0x9+-parseInt(_0x43cd31(0x203))/0xa;if(_0x1e756a===_0x31f1ee)break;else _0x44a451[_0x4724d8(0xe3)](_0x44a451[_0x429a1c(0xf3)]());}catch(_0x5dc895){_0x44a451[_0x429a1c(0xeb)](_0x44a451[_0x429a1c(0xf3)]());}}}(_0x3102,0x7173e));function _0x1c65(){const _0x25338c=_0x406b,_0xd268d5=[_0x25338c(0xf0),'21oCUEgp',_0x25338c(0xeb),_0x25338c(0xf2),'730415MmuteS',_0x25338c(0xe8),_0x25338c(0xe2),'setAttribute',_0x25338c(0x101),_0x25338c(0xcf),_0x25338c(0xd6),'touchstart',_0x25338c(0xd4),'body',_0x25338c(0x103),_0x25338c(0xec),_0x25338c(0x102),_0x25338c(0xd1),_0x25338c(0xf7),_0x25338c(0xe3),_0x25338c(0xdf),'getElementById',_0x25338c(0xfb),_0x25338c(0xdb),_0x25338c(0xfe),_0x25338c(0xc9),'load',_0x25338c(0xdd),_0x25338c(0xe1),_0x25338c(0xbb),_0x25338c(0xd8),'AnimationMixer',_0x25338c(0xee),_0x25338c(0xfd),_0x25338c(0xd7),'loop',_0x25338c(0xf9),_0x25338c(0xf8),_0x25338c(0xf3),_0x25338c(0xf6),_0x25338c(0xba),_0x25338c(0xbd),_0x25338c(0xd3),_0x25338c(0xed),'GLTFLoader',_0x25338c(0xe5),_0x25338c(0xdc),_0x25338c(0xfc),_0x25338c(0xc4),_0x25338c(0xbc),_0x25338c(0xda),_0x25338c(0xcd),_0x25338c(0xd0),'update',_0x25338c(0xc5),_0x25338c(0xd5),'scene',_0x25338c(0xe9),'fov',_0x25338c(0xb8),_0x25338c(0xef),'clientX',_0x25338c(0xfa),_0x25338c(0xde),_0x25338c(0xb9),'volume','wheel'];return _0x1c65=function(){return _0xd268d5;},_0x1c65();}function _0x89c6(_0x3fff47,_0x44c4aa){const _0x4fe381=_0x1c65();return _0x89c6=function(_0x178dc8,_0x13a088){_0x178dc8=_0x178dc8-0xc0;let _0xcdf502=_0x4fe381[_0x178dc8];return _0xcdf502;},_0x89c6(_0x3fff47,_0x44c4aa);}const scene=new THREE[(_0x2974bd(0x1de))](),camera=new THREE[(_0x2974bd(0x1d5))](0x4b,window[_0x2974bd(0x1d6)]/window[_0x2974bd(0x1e9)],0.1,0x3e8),renderer=new THREE[(_0x2974bd(0x1d4))]({'antialias':!![]});function _0x406b(_0x4b7abd,_0x3dc257){const _0x136ba2=_0x136b();return _0x406b=function(_0x406b26,_0x2e3023){_0x406b26=_0x406b26-0xb8;let _0x57c927=_0x136ba2[_0x406b26];return _0x57c927;},_0x406b(_0x4b7abd,_0x3dc257);}renderer[_0x2974bd(0x1f2)](window[_0x4e3234(0xfc)],window[_0x2974bd(0x1e9)]),renderer[_0x2974bd(0x1fb)][_0x2974bd(0x1dd)][_0x4e3234(0xe4)]=_0x2974bd(0x1f7),document[_0x16fa28(0xc8)][_0x4e3234(0xf1)](renderer[_0x4e3234(0xf9)]);const light=new THREE[(_0x2974bd(0x1e1))](0xffffff,0x1);function _0x3102(){const _0x4d38db=_0x16fa28,_0xdf156a=_0x4e3234,_0x8e051d=[_0x4d38db(0xe6),_0x4d38db(0xc2),_0xdf156a(0x101),_0xdf156a(0xcf),_0x4d38db(0xf1),_0x4d38db(0xf5),_0xdf156a(0xfc),'296364xdceZv',_0xdf156a(0x100),_0x4d38db(0xea),_0x4d38db(0xcb),_0xdf156a(0xed),_0xdf156a(0xd1),_0xdf156a(0xda),_0xdf156a(0xce),_0xdf156a(0xe7),_0xdf156a(0xc7),_0xdf156a(0xe0),'4073247ConGLm',_0xdf156a(0xc5),_0x4d38db(0xd2),_0xdf156a(0xe2),_0xdf156a(0xcd),_0xdf156a(0xe8),_0x4d38db(0xce),_0x4d38db(0xe4),_0xdf156a(0xef),_0xdf156a(0xf0),_0xdf156a(0xc8),_0xdf156a(0xec),_0xdf156a(0xd9),_0xdf156a(0xe5),_0xdf156a(0xc4),_0xdf156a(0xc0),_0x4d38db(0x105),_0xdf156a(0xd0),_0xdf156a(0xc9),_0xdf156a(0xc3),_0xdf156a(0xfd),'saturate(0.7)',_0x4d38db(0xbe),_0xdf156a(0xf4),_0xdf156a(0xcc),_0xdf156a(0xf9),_0xdf156a(0xe6),_0xdf156a(0xd6),_0xdf156a(0xf5),_0xdf156a(0xfb),_0xdf156a(0xdb),_0xdf156a(0xf6),_0xdf156a(0xd3),_0xdf156a(0xd4),_0xdf156a(0xd2),_0x4d38db(0xca),_0xdf156a(0xd7),_0xdf156a(0xf7),_0xdf156a(0xdf),_0x4d38db(0x100),'max',_0xdf156a(0xdd),_0xdf156a(0xc1),_0xdf156a(0xf1)];return _0x3102=function(){return _0x8e051d;},_0x3102();}function _0x136b(){const _0x23f763=['1477149zVxyYX','10XjkThG','53624wNuwQX','1049783AZYlnC','3846887WZtwRy','playButton','485954iifzGE','2590929dObjYG','917AQAlwT','body','appendChild','min','touchmove','4Gftgfu','touches','766148MFlKYl','40JdwZWn','861659ULuwas','display','updateProjectionMatrix','pow','filter','addEventListener','src','5738913CkgSVC','mousedown','mousemove','add','set','length','shift','4486080jKmNVu','createElement','166688StBHEa','animations','disable-devtool-auto','push','innerHeight','67972zHMmce','rotation','5425500jLWXKO','Erro\x20ao\x20carregar\x20o\x20modelo:','Scene','error','style','https://cdn.jsdelivr.net/npm/disable-devtool@latest','sqrt','script','clipAction','none','WebGLRenderer','deltaY','8EtcvYc','254805qFvPzu','PerspectiveCamera','resize','position','mouseup','innerWidth','5cMUBdE','2562048Ktqybm','8htqXnx','domElement','clientY','8maViHv','render','AmbientLight','click','Li4vdHJvcGljYWxfaXNsYW5kL3NjZW5lLmdsdGY=','forEach','setSize','play','120471IbxHwG','../assets/music.mp3','overlay','215194LbAEZq','touchend','3284676aKKjJB'];_0x136b=function(){return _0x23f763;};return _0x136b();}scene[_0x2974bd(0x1e0)](light);const loader=new THREE[(_0x2974bd(0x1ce))]();let mixer;const footer=_0x2974bd(0x1fc),path=atob(footer);loader[_0x4e3234(0xf2)](path,_0x13b20a=>{const _0x5aa435=_0x16fa28,_0x5e3131=_0x2974bd;scene[_0x5aa435(0xda)](_0x13b20a[_0x5e3131(0x1e6)]),_0x13b20a['animations']&&_0x13b20a[_0x5e3131(0x1f9)][_0x5e3131(0x1f5)]&&(mixer=new THREE[(_0x5e3131(0x1c9))](_0x13b20a[_0x5e3131(0x1e6)]),_0x13b20a[_0x5e3131(0x1f9)][_0x5aa435(0x104)](_0x1fb91b=>mixer[_0x5e3131(0x1dc)](_0x1fb91b)[_0x5e3131(0x1f3)]()));},undefined,_0x31a639=>console[_0x2974bd(0x1d9)](_0x2974bd(0x1cd),_0x31a639)),camera[_0x4e3234(0xea)][_0x2974bd(0x1ea)](0x1,0.4,-1.6),camera[_0x2974bd(0x1d0)]['y']=4.1,camera[_0x2974bd(0x1d0)]['x']=0x0;let isDragging=![],previousMousePosition={'x':0x0,'y':0x0},touchStart={'x':0x0,'y':0x0},previousTouchDistance=null;document[_0x2974bd(0x1fa)](_0x2974bd(0x201),_0x2bfd79=>{const _0x220a77=_0x2974bd;isDragging=!![],previousMousePosition={'x':_0x2bfd79[_0x220a77(0x204)],'y':_0x2bfd79[_0x220a77(0x1eb)]};}),document[_0x2974bd(0x1fa)](_0x2974bd(0x1f6),()=>isDragging=![]),document[_0x4e3234(0xcc)](_0x16fa28(0xd9),_0xb5b64=>{const _0x259bd7=_0x4e3234,_0x22a64b=_0x2974bd;if(isDragging){const _0x29d71f={'x':_0xb5b64[_0x22a64b(0x204)]-previousMousePosition['x'],'y':_0xb5b64[_0x22a64b(0x1eb)]-previousMousePosition['y']};camera[_0x22a64b(0x1d0)]['y']-=_0x29d71f['x']*0.002,previousMousePosition={'x':_0xb5b64[_0x259bd7(0xd2)],'y':_0xb5b64[_0x22a64b(0x1eb)]};}}),document[_0x2974bd(0x1fa)](_0x2974bd(0x206),_0x494282=>{const _0x10a126=_0x2974bd;camera[_0x10a126(0x1d3)]+=_0x494282[_0x10a126(0x200)]*0.05,camera[_0x10a126(0x1d3)]=Math[_0x10a126(0x1cc)](0x1e,Math[_0x10a126(0x205)](0x64,camera[_0x10a126(0x1d3)])),camera[_0x10a126(0x1e4)]();}),document[_0x2974bd(0x1fa)](_0x4e3234(0xe3),_0x396b78=>{const _0x5efac8=_0x2974bd;_0x396b78[_0x5efac8(0x1ec)][_0x5efac8(0x1f5)]==0x1&&(isDragging=!![],touchStart={'x':_0x396b78[_0x5efac8(0x1ec)][0x0][_0x5efac8(0x204)],'y':_0x396b78['touches'][0x0][_0x5efac8(0x1eb)]});}),document[_0x4e3234(0xcc)](_0x2974bd(0x1da),_0x240bc4=>{const _0x2e52e2=_0x16fa28,_0x26729f=_0x4e3234,_0x390e53=_0x2974bd;if(isDragging&&_0x240bc4[_0x26729f(0xc8)][_0x390e53(0x1f5)]===0x1){const _0x2d6a45={'x':_0x240bc4[_0x390e53(0x1ec)][0x0][_0x390e53(0x204)]-touchStart['x'],'y':_0x240bc4[_0x26729f(0xc8)][0x0][_0x390e53(0x1eb)]-touchStart['y']};camera[_0x390e53(0x1d0)]['y']-=_0x2d6a45['x']*0.002,touchStart={'x':_0x240bc4[_0x2e52e2(0xcd)][0x0][_0x26729f(0xd2)],'y':_0x240bc4[_0x390e53(0x1ec)][0x0][_0x390e53(0x1eb)]};}if(_0x240bc4[_0x26729f(0xc8)][_0x26729f(0xc3)]===0x2){const _0x3ad37c=Math[_0x390e53(0x1f1)](Math[_0x26729f(0x102)](_0x240bc4[_0x390e53(0x1ec)][0x0][_0x390e53(0x204)]-_0x240bc4[_0x26729f(0xc8)][0x1][_0x390e53(0x204)],0x2)+Math['pow'](_0x240bc4[_0x390e53(0x1ec)][0x0][_0x26729f(0xf0)]-_0x240bc4[_0x390e53(0x1ec)][0x1][_0x390e53(0x1eb)],0x2));if(previousTouchDistance!==null){const _0x41455c=(_0x3ad37c-previousTouchDistance)*0.1;camera[_0x390e53(0x1d3)]-=_0x41455c,camera[_0x390e53(0x1d3)]=Math[_0x390e53(0x1cc)](0x1e,Math[_0x390e53(0x205)](0x64,camera[_0x26729f(0xcf)])),camera[_0x390e53(0x1e4)]();}previousTouchDistance=_0x3ad37c;}}),document[_0x2974bd(0x1fa)](_0x2974bd(0x1d2),()=>{isDragging=![],previousTouchDistance=null;});const initialFov=camera[_0x2974bd(0x1d3)],initialHeight=window[_0x2974bd(0x1e9)];window[_0x2974bd(0x1fa)](_0x4e3234(0xff),()=>{const _0x38ff57=_0x16fa28,_0x1340b6=_0x2974bd,_0xca76be=window[_0x38ff57(0xe4)]/ initialHeight;camera[_0x1340b6(0x1d3)]=Math[_0x1340b6(0x1cc)](0x1e,Math[_0x1340b6(0x205)](0x64,initialFov/_0xca76be)),camera[_0x1340b6(0x1e4)](),renderer[_0x1340b6(0x1f2)](window[_0x1340b6(0x1d6)],window[_0x1340b6(0x1e9)]);});function animate(){const _0x27c945=_0x4e3234,_0x35b960=_0x2974bd;requestAnimationFrame(animate);if(mixer)mixer[_0x27c945(0xca)](0.01);renderer[_0x35b960(0x1cb)](scene,camera);}animate();const audio=new Audio(_0x2974bd(0x1d8));audio[_0x2974bd(0x1ff)]=!![],audio[_0x2974bd(0x1fd)]=0.4,document[_0x2974bd(0x1db)](_0x2974bd(0x1e3))[_0x4e3234(0xcc)](_0x2974bd(0x1e7),function(){const _0x10e0b8=_0x4e3234,_0x390cfd=_0x2974bd;document[_0x390cfd(0x1db)](_0x390cfd(0x1fe))[_0x390cfd(0x1dd)][_0x10e0b8(0xe9)]=_0x10e0b8(0xd8),audio[_0x390cfd(0x1f3)]();});const script=document[_0x2974bd(0x1ed)](_0x4e3234(0xf8));script[_0x2974bd(0x1e5)]=_0x2974bd(0x1df),script[_0x2974bd(0x1ca)](_0x4e3234(0xde),''),document[_0x2974bd(0x1ef)][_0x2974bd(0x1cf)](script);

  </script>
  
  <script>
      document.getElementById('playButton').addEventListener('click', function() {
      document.getElementById('overlay').style.display = 'none';
      document.getElementById('pointsContainer').style.display = 'flex';
      audio.play();
    });
  </script>
</body>
</html>
